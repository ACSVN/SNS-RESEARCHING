## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
numberRecord = 50
token <- get_token()
##Check current token
get_token()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
##Check current token
get_token()
token <- get_token()
tmp <- rate_limit(token, "search_30day")
tmp
tmp$re
tmp$reset
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
gmtDate <- as.POSIXlt(Sys.time(), "GMT") # the current time in UTC
todate <- format(gmtDate, "%Y%m%d%H%M")
todate
gmtDate
todate
test <- substr(todate, 8, 10)
test
test <- substr(todate, 10, 12)
test
test <- substr(todate, 11, 12)
test
no = test - 1
no = as.numeric(test) - 1
no
startStr <- substr(todate, 1, 10)
startStr
todate
gmtDate <- as.POSIXlt(Sys.time(), "GMT") # the current time in UTC
todate <- format(gmtDate, "%Y%m%d%H%M")
tmp <- paste0(substr(todate, 1, 10), "0", as.numeric(substr(todate, 11, 12)) - 1)
tmp
todate
gmtDate <- as.POSIXlt(Sys.time(), "GMT") # the current time in UTC
todate <- format(gmtDate, "%Y%m%d%H%M")
todate
no = as.numeric(substr(todate, 11, 12)) - 1
mydate = ""
if(no > 10){
mydate <- paste0(substr(todate, 1, 10), no)
}else{
mydate <- paste0(substr(todate, 1, 10), "0", no)
}
mydate
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
## --------------------- Run program ---------------------
# nhan_token = "tweeter-nhanlam-token.rds"
# addixcs_token = "tweeter-addixcs-token.rds"
# func_getTokenAccount(nhan_token)
func_setPremiumAccount()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
## --------------------- Run program ---------------------
# nhan_token = "tweeter-nhanlam-token.rds"
# addixcs_token = "tweeter-addixcs-token.rds"
# func_getTokenAccount(nhan_token)
func_setPremiumAccount()
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
func_moveFile2Folder(inPowerPointFile, outFolder)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
message("Finish output to powerpoint file")
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
# func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
#
# ## Call macro from excel file
# myFileName =  paste0(getwd(),"/output/",excelFileName)
# macroName = "Main"
# func_RCallExcelMacro(myFileName, macroName)
# message("Finish output to powerpoint file")
#
#
# ## create folder donald trump
# myNewFolder <- paste0(getwd(),"/output/",username)
# func_createFolder(myNewFolder)
# ## Copy 2 file and paste to folder donald trump
# outExcelFile <- paste0(getwd(),"/output/",excelFileName)
# outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
# func_moveFile2Folder(outExcelFile, myNewFolder)
# func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
func_mainProgram(excelFileName, excelFileName, pptFileName, username, numberRecord, sheetName)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
# func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
#
# ## Call macro from excel file
# myFileName =  paste0(getwd(),"/output/",excelFileName)
# macroName = "Main"
# func_RCallExcelMacro(myFileName, macroName)
# message("Finish output to powerpoint file")
#
#
# ## create folder donald trump
# myNewFolder <- paste0(getwd(),"/output/",username)
# func_createFolder(myNewFolder)
# ## Copy 2 file and paste to folder donald trump
# outExcelFile <- paste0(getwd(),"/output/",excelFileName)
# outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
# func_moveFile2Folder(outExcelFile, myNewFolder)
# func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, pptFileName, username, numberRecord, sheetName)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
# func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
#
# ## Call macro from excel file
# myFileName =  paste0(getwd(),"/output/",excelFileName)
# macroName = "Main"
# func_RCallExcelMacro(myFileName, macroName)
# message("Finish output to powerpoint file")
#
#
# ## create folder donald trump
# myNewFolder <- paste0(getwd(),"/output/",username)
# func_createFolder(myNewFolder)
# ## Copy 2 file and paste to folder donald trump
# outExcelFile <- paste0(getwd(),"/output/",excelFileName)
# outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
# func_moveFile2Folder(outExcelFile, myNewFolder)
# func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, pptFileName, username, numberRecord, sheetName)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
message("Finish output to powerpoint file")
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, pptFileName, username, numberRecord, sheetName)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
message("Finish output to powerpoint file")
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, pptFileName, username, numberRecord, sheetName)
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("stringr")
# install.packages("magrittr")
# install.packages("imager")
# install.packages("openxlsx")
# install.packages("devtools")
# install_github("omegahat/RDCOMClient")
# install.packages("jjb")
## --------------------- set work directory
setwd("D:/MyProjects/Sources/12. SNS Develop/GitHub/RCallTwitter")
getwd()
# ------------------------------------------------------- #
source("./sources/TweetFunction.R")
source("./sources/Export2Excel.R")
source("./sources/CallMacroExcel.R")
source("./sources/FileAndFolder.R")
## --------------------- Run program ---------------------
addixcs_token = "ADDIXCS-Premium.rds"
func_getTokenAccount(addixcs_token)
# func_setPremiumAccount()
##Check current token
get_token()
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
message("Finish output to powerpoint file")
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
func_mainProgram(excelFileName, pptFileName, username, numberRecord, sheetName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/","Twitter-Excel.xlsx")
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/","Twitter-Excel.xlsx")
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/","Twitter-Excel.xlsm")
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
## --------------------- Main program ---------------------
func_mainProgram <- function(excelFileName, pptFileName, username, numberRecord, sheetName){
## Copy powerpoint file from input folder to output folder
inPowerPointFile <- paste0(getwd(),"/input/", pptFileName)
outFolder <- paste0(getwd(),"/output")
print(inPowerPointFile)
print(outFolder)
func_moveFile2Folder(inPowerPointFile, outFolder)
func_write2ExcelTweet(excelFileName, func_getUserTweet_30Days_premium(username, numberRecord), sheetName)
}
func_move2Folder <- function(username, excelFileName, pptFileName){
## create folder donald trump
myNewFolder <- paste0(getwd(),"/output/",username)
func_createFolder(myNewFolder)
## Copy 2 file and paste to folder donald trump
outExcelFile <- paste0(getwd(),"/output/",excelFileName)
outPowerPointFile <- paste0(getwd(),"/output/", pptFileName)
func_moveFile2Folder(outExcelFile, myNewFolder)
func_moveFile2Folder(outPowerPointFile, myNewFolder)
}
## --------------------- Test Output Excel Case ---------------------
username = "realDonaldTrump"
sheetName = "Twitter"
excelFileName = "Twitter-Excel.xlsm"
pptFileName = "Twitter-PPT.pptx"
numberRecord = 50
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/",excelFileName)
macroName = "Main"
func_RCallExcelMacro(myFileName, macroName)
## Call macro from excel file
myFileName =  paste0(getwd(),"/output/", "Book1.xlsm")
macroName = "hello"
func_RCallExcelMacro(myFileName, macroName)
